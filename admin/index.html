<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ç»© - ç®¡ç†åå°</title>
    <style>
        /* å…¨å±€æ ·å¼ */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            height: 100vh;
            display: flex;
            background-color: #f5f7fa;
            color: #333;
        }
        
        /* ä¾§è¾¹æ æ ·å¼ */
        .sidebar {
            width: 250px;
            background: linear-gradient(135deg, #3a1c71 0%, #d76d77 100%);
            color: white;
            padding: 20px;
            display: flex;
            flex-direction: column;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        }
        
        .sidebar-header {
            margin-bottom: 40px;
            text-align: center;
        }
        
        .sidebar-logo {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .sidebar-title {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .nav-item {
            padding: 12px 20px;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            font-weight: 500;
        }
        
        .nav-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .nav-item.active {
            background-color: rgba(255, 255, 255, 0.2);
            font-weight: 600;
        }
        
        .nav-icon {
            margin-right: 12px;
            font-size: 1.1rem;
        }
        
        .sidebar-footer {
            margin-top: auto;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logout-btn {
            width: 100%;
            padding: 12px;
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .logout-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        /* ä¸»å†…å®¹åŒºåŸŸæ ·å¼ */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .header {
            height: 60px;
            background-color: white;
            padding: 0 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .header-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
        }
        
        .user-info {
            display: flex;
            align-items: center;
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: #3a1c71;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: 600;
        }
        
        .user-name {
            font-weight: 500;
        }
        
        .content-wrapper {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }
        
        /* å¡ç‰‡æ ·å¼ */
        .card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
        }
        
        /* ç»Ÿè®¡å¡ç‰‡æ ·å¼ */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
        }
        
        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            font-size: 1.5rem;
        }
        
        .stat-icon.pending {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .stat-icon.approved {
            background-color: #d4edda;
            color: #155724;
        }
        
        .stat-icon.rejected {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .stat-icon.total {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        
        .stat-info h3 {
            font-size: 2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }
        
        .stat-info p {
            color: #666;
            font-size: 0.95rem;
        }
        
        /* è¡¨æ ¼æ ·å¼ */
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .data-table th,
        .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .data-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #333;
        }
        
        .data-table tr:hover {
            background-color: #f8f9fa;
        }
        
        /* çŠ¶æ€æ ‡ç­¾æ ·å¼ */
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .status-badge.pending {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-badge.approved {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-badge.rejected {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        /* æŒ‰é’®æ ·å¼ */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .btn-primary {
            background-color: #3a1c71;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #d62f6f;
        }
        
        /* æ“ä½œæŒ‰é’®å®¹å™¨ */
        .action-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        /* å°æŒ‰é’®æ ·å¼ */
        .btn-sm {
            padding: 4px 12px;
            font-size: 0.8rem;
            border-radius: 4px;
        }
        
        /* å±é™©æŒ‰é’® */
        .btn-danger {
            background-color: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c82333;
        }
        
        /* æˆåŠŸæŒ‰é’® */
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        .btn-danger {
            background-color: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c82333;
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 0.85rem;
        }
        
        /* åŠ è½½çŠ¶æ€æ ·å¼ */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
            color: #666;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top-color: #3a1c71;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }
            
            .nav-text {
                display: none;
            }
            
            .nav-icon {
                margin-right: 0;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .content-wrapper {
                padding: 20px;
            }
        }
        
        /* æ“ä½œæŒ‰é’®ç»„æ ·å¼ */
        .action-buttons {
            display: flex;
            gap: 8px;
        }
    </style>
</head>
<body>
    <!-- ä¾§è¾¹æ  -->
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">å°ç»©</div>
            <div class="sidebar-title">ç®¡ç†åå°</div>
        </div>
        
        <div class="nav-item active" data-page="dashboard">
            <span class="nav-icon">ğŸ“Š</span>
            <span class="nav-text">æ•°æ®æ¦‚è§ˆ</span>
        </div>
        
        <div class="nav-item" data-page="registrations">
            <span class="nav-icon">âœ…</span>
            <span class="nav-text">æ³¨å†Œå®¡æ ¸</span>
        </div>
        
        <div class="nav-item" data-page="companies">
            <span class="nav-icon">ğŸ¢</span>
            <span class="nav-text">ä¼ä¸šç®¡ç†</span>
        </div>
        
        <div class="nav-item" data-page="credentials">
            <span class="nav-icon">ğŸ“„</span>
            <span class="nav-text">å‡­è¯ç®¡ç†</span>
        </div>
        
        <div class="nav-item" data-page="verification-limits">
            <span class="nav-icon">ğŸ”’</span>
            <span class="nav-text">éªŒè¯æ¬¡æ•°é…ç½®</span>
        </div>
        
        <div class="nav-item" data-page="permissions">
            <span class="nav-icon">ğŸ‘¥</span>
            <span class="nav-text">æƒé™ç®¡ç†</span>
        </div>
        
        <div class="sidebar-footer">
            <button class="logout-btn" id="logout-btn">
                <span class="nav-icon">ğŸšª</span>
                <span class="nav-text">é€€å‡ºç™»å½•</span>
            </button>
        </div>
    </div>
    
    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div class="main-content">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <div class="header-title" id="page-title">æ•°æ®æ¦‚è§ˆ</div>
            <div class="user-info">
                <div class="user-avatar">A</div>
                <div class="user-name" id="admin-name">ç®¡ç†å‘˜</div>
            </div>
        </div>
        
        <!-- å†…å®¹åŒºåŸŸ -->
        <div class="content-wrapper">
            <!-- æ•°æ®æ¦‚è§ˆ -->
            <div id="dashboard-content">
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-icon pending">â³</div>
                        <div class="stat-info">
                            <h3 id="pending-count">0</h3>
                            <p>å¾…å®¡æ ¸ä¼ä¸š</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon approved">âœ…</div>
                        <div class="stat-info">
                            <h3 id="approved-count">0</h3>
                            <p>å·²é€šè¿‡ä¼ä¸š</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon rejected">âŒ</div>
                        <div class="stat-info">
                            <h3 id="rejected-count">0</h3>
                            <p>å·²æ‹’ç»ä¼ä¸š</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon total">ğŸ“Š</div>
                        <div class="stat-info">
                            <h3 id="total-count">0</h3>
                            <p>æ€»ä¼ä¸šæ•°</p>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">å¾…å®¡æ ¸ä¼ä¸šåˆ—è¡¨</h3>
                        <button class="btn btn-primary" onclick="showPage('registrations')">æŸ¥çœ‹å…¨éƒ¨</button>
                    </div>
                    
                    <div id="pending-list" class="loading">
                        <div class="loading-spinner"></div>
                        åŠ è½½ä¸­...
                    </div>
                </div>
            </div>
            
            <!-- æ³¨å†Œå®¡æ ¸é¡µé¢ (åˆå§‹éšè—) -->
            <div id="registrations-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ä¼ä¸šæ³¨å†Œå®¡æ ¸</h3>
                    </div>
                    
                    <div id="registrations-list" class="loading">
                        <div class="loading-spinner"></div>
                        åŠ è½½ä¸­...
                    </div>
                </div>
            </div>
            
            <!-- ä¼ä¸šç®¡ç†é¡µé¢ (åˆå§‹éšè—) -->
            <div id="companies-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ä¼ä¸šç®¡ç†</h3>
                    </div>
                    
                    <div class="card" style="margin-bottom: 20px;">
                        <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                            <input type="text" id="company-search" placeholder="æœç´¢ä¼ä¸šåç§°" style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 6px; flex: 1; max-width: 300px;">
                            <button class="btn btn-primary" onclick="searchCompanies()">æœç´¢</button>
                        </div>
                        
                        <div id="companies-list" class="loading">
                            <div class="loading-spinner"></div>
                            åŠ è½½ä¸­...
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- å‡­è¯ç®¡ç†é¡µé¢ (åˆå§‹éšè—) -->
    <div id="credentials-content" style="display: none;">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">å‡­è¯ç®¡ç†</h3>
            </div>
            
            <div class="card" style="margin-bottom: 20px;">
                <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                    <select id="credentials-company" style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 6px; flex: 1; max-width: 200px;">
                        <option value="">æ‰€æœ‰ä¼ä¸š</option>
                    </select>
                    <input type="text" id="credentials-search" placeholder="æœç´¢å‡­è¯IDæˆ–åç§°" style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 6px; flex: 1; max-width: 300px;">
                    <button class="btn btn-primary" onclick="searchCredentials()">æœç´¢</button>
                </div>
                
                <div id="credentials-list" class="loading">
                    <div class="loading-spinner"></div>
                    åŠ è½½ä¸­...
                </div>
            </div>
        </div>
    </div>
    
    <!-- éªŒè¯æ¬¡æ•°é…ç½®é¡µé¢ (åˆå§‹éšè—) -->
    <div id="verification-limits-content" style="display: none;">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">å…¨å±€éªŒè¯æ¬¡æ•°è®¾ç½®</h3>
            </div>
            <div class="card-body">
                <div class="form-group">
                    <label for="max-verifications">å•æ¬¡å‡­è¯æœ€å¤§éªŒè¯æ¬¡æ•°</label>
                    <input type="number" id="max-verifications" min="0" max="9999" placeholder="è¯·è¾“å…¥æœ€å¤§éªŒè¯æ¬¡æ•°">
                    <small class="form-text">è®¾ç½®ä¸º0è¡¨ç¤ºä¸é™åˆ¶éªŒè¯æ¬¡æ•°</small>
                </div>
                <div class="form-group">
                    <label for="verification-window">éªŒè¯çª—å£ï¼ˆå°æ—¶ï¼‰</label>
                    <input type="number" id="verification-window" min="1" max="168" placeholder="è¯·è¾“å…¥éªŒè¯çª—å£æ—¶é—´">
                    <small class="form-text">åœ¨è¯¥æ—¶é—´èŒƒå›´å†…ç»Ÿè®¡éªŒè¯æ¬¡æ•°</small>
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="enable-notifications">
                        å¯ç”¨è¶…é™é€šçŸ¥
                    </label>
                    <small class="form-text">å½“éªŒè¯æ¬¡æ•°è¶…è¿‡é™åˆ¶æ—¶å‘é€é€šçŸ¥</small>
                </div>
                <button id="save-limits-btn" class="btn btn-primary">ä¿å­˜é…ç½®</button>
                <div id="limits-message" class="message"></div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">éªŒè¯ç»Ÿè®¡</h3>
            </div>
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-info">
                        <h3 id="today-verifications">0</h3>
                        <p>ä»Šæ—¥éªŒè¯æ¬¡æ•°</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“ˆ</div>
                    <div class="stat-info">
                        <h3 id="month-verifications">0</h3>
                        <p>æœ¬æœˆéªŒè¯æ¬¡æ•°</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">âš ï¸</div>
                    <div class="stat-info">
                        <h3 id="limit-exceeded">0</h3>
                        <p>è¶…é™æ¬¡æ•°</p>
                    </div>
                </div>
              </div>
         </div>
     </div>
     
     <!-- æƒé™ç®¡ç†é¡µé¢ (åˆå§‹éšè—) -->
     <div id="permissions-content" style="display: none;">
         <div class="card">
             <div class="card-header">
                 <h3 class="card-title">ç”¨æˆ·ç®¡ç†</h3>
                 <button id="add-user-btn" class="btn btn-primary">æ·»åŠ ç”¨æˆ·</button>
             </div>
             <div class="table-responsive">
                 <table class="data-table" id="users-table">
                     <thead>
                         <tr>
                             <th>ç”¨æˆ·å</th>
                             <th>é‚®ç®±</th>
                             <th>è§’è‰²</th>
                             <th>åˆ›å»ºæ—¶é—´</th>
                             <th>çŠ¶æ€</th>
                             <th>æ“ä½œ</th>
                         </tr>
                     </thead>
                     <tbody>
                         <!-- ç”¨æˆ·æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                     </tbody>
                 </table>
             </div>
             <div id="permissions-message" class="message"></div>
         </div>
         
         <div class="card">
             <div class="card-header">
                 <h3 class="card-title">è§’è‰²å®šä¹‰</h3>
             </div>
             <div class="role-cards">
                 <div class="role-card">
                     <h4>ç®¡ç†å‘˜</h4>
                     <p>æ‹¥æœ‰ç³»ç»Ÿçš„æ‰€æœ‰æƒé™ï¼ŒåŒ…æ‹¬ç”¨æˆ·ç®¡ç†å’Œç³»ç»Ÿé…ç½®</p>
                 </div>
                 <div class="role-card">
                     <h4>æ“ä½œå‘˜</h4>
                     <p>å¯ä»¥å®¡æ ¸æ³¨å†Œã€ç®¡ç†å‡­è¯å’ŒæŸ¥çœ‹æ•°æ®</p>
                 </div>
                 <div class="role-card">
                     <h4>æŸ¥çœ‹è€…</h4>
                     <p>åªèƒ½æŸ¥çœ‹æ•°æ®å’Œç»Ÿè®¡ä¿¡æ¯ï¼Œæ— æ“ä½œæƒé™</p>
                 </div>
             </div>
         </div>
     </div>
            

            

        </div>
    </div>
    
    <script>
        // è·å–é¡µé¢å…ƒç´ 
        const navItems = document.querySelectorAll('.nav-item');
        const logoutBtn = document.getElementById('logout-btn');
        const adminName = document.getElementById('admin-name');
        const pageTitle = document.getElementById('page-title');
        
        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async () => {
            // æ£€æŸ¥ç®¡ç†å‘˜ç™»å½•çŠ¶æ€
            if (!localStorage.getItem('adminToken')) {
                window.location.href = 'login.html';
                return;
            }
            
            // åŠ è½½ç®¡ç†å‘˜ä¿¡æ¯
            try {
                const adminInfo = JSON.parse(localStorage.getItem('adminInfo'));
                if (adminInfo) {
                    adminName.textContent = adminInfo.username || 'ç®¡ç†å‘˜';
                }
            } catch (error) {
                console.error('è§£æç®¡ç†å‘˜ä¿¡æ¯å¤±è´¥:', error);
            }
            
            // åŠ è½½ä»ªè¡¨æ¿æ•°æ®
            loadDashboardData();
            loadPendingList();
        });
        
        // æ˜¾ç¤ºæŒ‡å®šé¡µé¢
        function showPage(pageId) {
            // éšè—æ‰€æœ‰å†…å®¹åŒºåŸŸ
            document.querySelectorAll('[id$="-content"]').forEach(content => {
                content.style.display = 'none';
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„å†…å®¹åŒºåŸŸ
            document.getElementById(`${pageId}-content`).style.display = 'block';
            
            // æ›´æ–°å¯¼èˆªæ æ¿€æ´»çŠ¶æ€
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-page') === pageId) {
                    item.classList.add('active');
                }
            });
            
            // æ›´æ–°é¡µé¢æ ‡é¢˜
            const titles = {
                'dashboard': 'æ•°æ®æ¦‚è§ˆ',
                'registrations': 'ä¼ä¸šæ³¨å†Œå®¡æ ¸',
                'companies': 'ä¼ä¸šç®¡ç†',
                'credentials': 'å‡­è¯ç®¡ç†',
                'verification-limits': 'éªŒè¯æ¬¡æ•°é…ç½®',
                'permissions': 'æƒé™ç®¡ç†'
            };
            pageTitle.textContent = titles[pageId] || 'ç®¡ç†åå°';
            
            // åŠ è½½ç›¸åº”é¡µé¢çš„æ•°æ®
            if (pageId === 'registrations') {
                loadRegistrationsList();
            } else if (pageId === 'companies') {
                loadCompaniesList();
            } else if (pageId === 'credentials') {
                loadCredentialsList();
            } else if (pageId === 'verification-limits') {
                loadVerificationLimits();
            } else if (pageId === 'permissions') {
                loadUsersList();
            }
        }
        
        // ç»‘å®šå¯¼èˆªæ ç‚¹å‡»äº‹ä»¶
        navItems.forEach(item => {
            item.addEventListener('click', () => {
                const pageId = item.getAttribute('data-page');
                showPage(pageId);
            });
        });
        
        // åŠ è½½ä»ªè¡¨æ¿æ•°æ®
        async function loadDashboardData() {
            try {
                // è·å–æ³¨å†Œç”³è¯·åˆ—è¡¨
                const response = await fetch('/api/admin/registrations', {
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('adminToken')}`
                    }
                });
                
                if (response.ok) {
                    const registrations = await response.json();
                    
                    // ç»Ÿè®¡æ•°æ®
                    const pendingCount = registrations.filter(r => r.status === 'pending').length;
                    const approvedCount = registrations.filter(r => r.status === 'approved').length;
                    const rejectedCount = registrations.filter(r => r.status === 'rejected').length;
                    const totalCount = registrations.length;
                    
                    // æ›´æ–°ç»Ÿè®¡æ•°æ®æ˜¾ç¤º
                    document.getElementById('pending-count').textContent = pendingCount;
                    document.getElementById('approved-count').textContent = approvedCount;
                    document.getElementById('rejected-count').textContent = rejectedCount;
                    document.getElementById('total-count').textContent = totalCount;
                }
            } catch (error) {
                console.error('åŠ è½½ä»ªè¡¨æ¿æ•°æ®å¤±è´¥:', error);
            }
        }
        
        // åŠ è½½å¾…å®¡æ ¸ä¼ä¸šåˆ—è¡¨
        async function loadPendingList() {
            const pendingList = document.getElementById('pending-list');
            pendingList.innerHTML = '<div class="loading-spinner"></div>åŠ è½½ä¸­...';
            
            try {
                const response = await fetch('/api/admin/registrations', {
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('adminToken')}`
                    }
                });
                
                if (response.ok) {
                    const registrations = await response.json();
                    const pendingRegistrations = registrations.filter(r => r.status === 'pending').slice(0, 5);
                    
                    if (pendingRegistrations.length === 0) {
                        pendingList.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">æš‚æ— å¾…å®¡æ ¸ä¼ä¸š</p>';
                    } else {
                        let html = `
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>ä¼ä¸šåç§°</th>
                                        <th>è”ç³»äºº</th>
                                        <th>è”ç³»æ–¹å¼</th>
                                        <th>æäº¤æ—¶é—´</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody>
                        `;
                        
                        pendingRegistrations.forEach(item => {
                            const submitTime = new Date(item.created_at).toLocaleString('zh-CN');
                            html += `
                                <tr>
                                    <td>${item.company_name}</td>
                                    <td>${item.contact_person}</td>
                                    <td>${item.phone}</td>
                                    <td>${submitTime}</td>
                                    <td>
                                        <div class="action-buttons">
                                            <button class="btn btn-success btn-sm" onclick="approveRegistration('${item.id}')">é€šè¿‡</button>
                                            <button class="btn btn-danger btn-sm" onclick="rejectRegistration('${item.id}')">æ‹’ç»</button>
                                        </div>
                                    </td>
                                </tr>
                            `;
                        });
                        
                        html += '</tbody></table>';
                        pendingList.innerHTML = html;
                    }
                }
            } catch (error) {
                console.error('åŠ è½½å¾…å®¡æ ¸åˆ—è¡¨å¤±è´¥:', error);
                pendingList.innerHTML = '<p style="text-align: center; color: #dc3545; padding: 20px;">åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•</p>';
            }
        }
        
        // åŠ è½½æ‰€æœ‰æ³¨å†Œç”³è¯·åˆ—è¡¨
        async function loadRegistrationsList() {
            const registrationsList = document.getElementById('registrations-list');
            registrationsList.innerHTML = '<div class="loading-spinner"></div>åŠ è½½ä¸­...';
            
            try {
                const response = await fetch('/api/admin/registrations', {
                    headers: {
                        'Authorization': `Bearer ${localStorage.getItem('adminToken')}`
                    }
                });
                
                if (response.ok) {
                    const registrations = await response.json();
                    
                    if (registrations.length === 0) {
                        registrationsList.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">æš‚æ— æ³¨å†Œç”³è¯·</p>';
                    } else {
                        let html = `
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>ä¼ä¸šåç§°</th>
                                        <th>ä¼ä¸šID</th>
                                        <th>è”ç³»äºº</th>
                                        <th>è”ç³»æ–¹å¼</th>
                                        <th>çŠ¶æ€</th>
                                        <th>æäº¤æ—¶é—´</th>
                                        <th>æ“ä½œæ—¶é—´</th>
                                        <th>æ“ä½œäºº</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody>
                        `;
                        
                        registrations.forEach(item => {
                            const submitTime = new Date(item.created_at).toLocaleString('zh-CN');
                            const reviewTime = item.reviewed_at ? new Date(item.reviewed_at).toLocaleString('zh-CN') : '-';
                            const reviewer = item.reviewed_by || '-';
                            
                            let statusBadge = '';
                            if (item.status === 'pending') {
                                statusBadge = '<span class="status-badge pending">å¾…å®¡æ ¸</span>';
                            } else if (item.status === 'approved') {
                                statusBadge = '<span class="status-badge approved">å·²é€šè¿‡</span>';
                            } else if (item.status === 'rejected') {
                                statusBadge = '<span class="status-badge rejected">å·²æ‹’ç»</span>';
                            }
                            
                            let actions = '';
                            if (item.status === 'pending') {
                                actions = `
                                    <div class="action-buttons">
                                        <button class="btn btn-success btn-sm" onclick="approveRegistration('${item.id}')">é€šè¿‡</button>
                                        <button class="btn btn-danger btn-sm" onclick="rejectRegistration('${item.id}')">æ‹’ç»</button>
                                    </div>
                                `;
                            }
                            
                            html += `
                                <tr>
                                    <td>${item.company_name}</td>
                                    <td>${item.company_id}</td>
                                    <td>${item.contact_person}</td>
                                    <td>${item.phone}</td>
                                    <td>${statusBadge}</td>
                                    <td>${submitTime}</td>
                                    <td>${reviewTime}</td>
                                    <td>${reviewer}</td>
                                    <td>${actions}</td>
                                </tr>
                            `;
                        });
                        
                        html += '</tbody></table>';
                        registrationsList.innerHTML = html;
                    }
                }
            } catch (error) {
                console.error('åŠ è½½æ³¨å†Œç”³è¯·åˆ—è¡¨å¤±è´¥:', error);
                registrationsList.innerHTML = '<p style="text-align: center; color: #dc3545; padding: 20px;">åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•</p>';
            }
        }
        
        // æ‰¹å‡†æ³¨å†Œç”³è¯·
        async function approveRegistration(id) {
            if (confirm('ç¡®å®šè¦æ‰¹å‡†è¯¥ä¼ä¸šæ³¨å†Œç”³è¯·å—ï¼Ÿ')) {
                try {
                    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                    showLoading();
                    
                    // è°ƒç”¨APIæ›´æ–°çŠ¶æ€
                    const response = await fetch(`/api/admin/registrations/${id}/approve`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `Bearer ${localStorage.getItem('adminToken')}`,
                            'Content-Type': 'application/json'
                        }
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || 'æ‰¹å‡†å¤±è´¥');
                    }
                    
                    alert('æ‰¹å‡†æˆåŠŸï¼');
                    
                    // é‡æ–°åŠ è½½æ•°æ®
                    loadDashboardData();
                    loadPendingList();
                    if (document.getElementById('registrations-content').style.display !== 'none') {
                        loadRegistrationsList();
                    }
                } catch (error) {
                    console.error('æ‰¹å‡†æ³¨å†Œç”³è¯·å¤±è´¥:', error);
                    alert('æ“ä½œå¤±è´¥: ' + error.message);
                } finally {
                    hideLoading();
                }
            }
        }
        
        // æ‹’ç»æ³¨å†Œç”³è¯·
        async function rejectRegistration(id) {
            const reason = prompt('è¯·è¾“å…¥æ‹’ç»åŸå› ï¼š');
            if (reason) {
                try {
                    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                    showLoading();
                    
                    // è°ƒç”¨APIæ›´æ–°çŠ¶æ€
                    const response = await fetch(`/api/admin/registrations/${id}/reject`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `Bearer ${localStorage.getItem('adminToken')}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ reason })
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || 'æ‹’ç»å¤±è´¥');
                    }
                    
                    alert('æ‹’ç»æˆåŠŸï¼');
                    
                    // é‡æ–°åŠ è½½æ•°æ®
                    loadDashboardData();
                    loadPendingList();
                    if (document.getElementById('registrations-content').style.display !== 'none') {
                        loadRegistrationsList();
                    }
                } catch (error) {
                    console.error('æ‹’ç»æ³¨å†Œç”³è¯·å¤±è´¥:', error);
                    alert('æ“ä½œå¤±è´¥: ' + error.message);
                } finally {
                    hideLoading();
                }
            }
        }
        
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        function showLoading() {
            const loading = document.createElement('div');
            loading.id = 'global-loading';
            loading.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 9999;
                font-size: 18px;
                color: white;
            `;
            loading.innerHTML = `<div><div class="loading-spinner" style="width: 40px; height: 40px; margin-right: 15px;"></div>å¤„ç†ä¸­...</div>`;
            document.body.appendChild(loading);
        }
        
        // éšè—åŠ è½½çŠ¶æ€
        function hideLoading() {
            const loading = document.getElementById('global-loading');
            if (loading) {
                loading.remove();
            }
        }
        
        // éªŒè¯æ¬¡æ•°é…ç½®ç›¸å…³åŠŸèƒ½
        async function loadVerificationLimits() {
            try {
                // æ¨¡æ‹ŸåŠ è½½ç»Ÿè®¡æ•°æ®
                document.getElementById('today-verifications').textContent = Math.floor(Math.random() * 1000);
                document.getElementById('month-verifications').textContent = Math.floor(Math.random() * 10000);
                document.getElementById('limit-exceeded').textContent = Math.floor(Math.random() * 100);
                
                // ä»æœ¬åœ°å­˜å‚¨åŠ è½½è®¾ç½®
                const savedSettings = localStorage.getItem('verificationSettings');
                if (savedSettings) {
                    try {
                        const settings = JSON.parse(savedSettings);
                        document.getElementById('max-verifications').value = settings.maxVerifications || '';
                        document.getElementById('verification-window').value = settings.verificationWindow || '';
                        document.getElementById('enable-notifications').checked = settings.enableNotifications || false;
                    } catch (e) {
                        console.error('åŠ è½½éªŒè¯è®¾ç½®å¤±è´¥:', e);
                    }
                }
            } catch (error) {
                console.error('åŠ è½½éªŒè¯ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
            }
        }
        
        // ä¿å­˜éªŒè¯æ¬¡æ•°é…ç½®
        if (document.getElementById('save-limits-btn')) {
            document.getElementById('save-limits-btn').addEventListener('click', async () => {
                try {
                    const maxVerifications = document.getElementById('max-verifications').value;
                    const verificationWindow = document.getElementById('verification-window').value;
                    const enableNotifications = document.getElementById('enable-notifications').checked;
                    
                    // ç®€å•éªŒè¯
                    if (!maxVerifications || !verificationWindow) {
                        showMessage('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ', 'error');
                        return;
                    }
                    
                    // ä¿å­˜é…ç½®
                    const settings = {
                        maxVerifications: parseInt(maxVerifications),
                        verificationWindow: parseInt(verificationWindow),
                        enableNotifications: enableNotifications
                    };
                    
                    // æ¨¡æ‹Ÿä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                    localStorage.setItem('verificationSettings', JSON.stringify(settings));
                    
                    // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                    showMessage('é…ç½®ä¿å­˜æˆåŠŸ', 'success');
                } catch (error) {
                    console.error('ä¿å­˜éªŒè¯è®¾ç½®å¤±è´¥:', error);
                    showMessage('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                }
            });
        }
        
        // æƒé™ç®¡ç†ç›¸å…³åŠŸèƒ½
        async function loadUsersList() {
            try {
                const tableBody = document.querySelector('#users-table tbody');
                if (!tableBody) return;
                
                // æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®
                const users = [
                    {
                        username: 'admin',
                        email: 'admin@example.com',
                        role: 'ç®¡ç†å‘˜',
                        createdAt: '2023-01-15',
                        status: 'active'
                    },
                    {
                        username: 'operator1',
                        email: 'operator1@example.com',
                        role: 'æ“ä½œå‘˜',
                        createdAt: '2023-02-20',
                        status: 'active'
                    },
                    {
                        username: 'viewer1',
                        email: 'viewer1@example.com',
                        role: 'æŸ¥çœ‹è€…',
                        createdAt: '2023-03-10',
                        status: 'inactive'
                    }
                ];
                
                // æ¸…ç©ºè¡¨æ ¼
                tableBody.innerHTML = '';
                
                // å¡«å……è¡¨æ ¼æ•°æ®
                users.forEach(user => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${user.username}</td>
                        <td>${user.email}</td>
                        <td>${user.role}</td>
                        <td>${user.createdAt}</td>
                        <td>
                            <span class="status-badge ${user.status === 'active' ? 'active' : 'inactive'}">
                                ${user.status === 'active' ? 'å¯ç”¨' : 'ç¦ç”¨'}
                            </span>
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-primary btn-sm" onclick="editUser('${user.username}')">ç¼–è¾‘</button>
                                <button class="btn btn-warning btn-sm" onclick="toggleUserStatus('${user.username}', '${user.status}')">
                                    ${user.status === 'active' ? 'ç¦ç”¨' : 'å¯ç”¨'}
                                </button>
                                <button class="btn btn-danger btn-sm" onclick="deleteUser('${user.username}')">åˆ é™¤</button>
                            </div>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
            } catch (error) {
                console.error('åŠ è½½ç”¨æˆ·åˆ—è¡¨å¤±è´¥:', error);
            }
        }
        
        // æ·»åŠ ç”¨æˆ·æŒ‰é’®äº‹ä»¶
        if (document.getElementById('add-user-btn')) {
            document.getElementById('add-user-btn').addEventListener('click', function() {
                alert('æ·»åŠ ç”¨æˆ·åŠŸèƒ½å·²è§¦å‘ï¼Œåœ¨å®é™…åº”ç”¨ä¸­åº”æ˜¾ç¤ºæ·»åŠ ç”¨æˆ·è¡¨å•');
            });
        }
        
        // ç¼–è¾‘ç”¨æˆ·ï¼ˆå…¨å±€å‡½æ•°ï¼‰
        window.editUser = function(username) {
            alert(`ç¼–è¾‘ç”¨æˆ· ${username}ï¼Œåœ¨å®é™…åº”ç”¨ä¸­åº”æ˜¾ç¤ºç¼–è¾‘ç”¨æˆ·è¡¨å•`);
        };
        
        // åˆ é™¤ç”¨æˆ·ï¼ˆå…¨å±€å‡½æ•°ï¼‰
        window.deleteUser = function(username) {
            if (confirm(`ç¡®å®šè¦åˆ é™¤ç”¨æˆ· ${username} å—ï¼Ÿ`)) {
                // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥è°ƒç”¨APIåˆ é™¤ç”¨æˆ·
                showMessage('ç”¨æˆ·åˆ é™¤æˆåŠŸ', 'success');
                loadUsersList(); // é‡æ–°åŠ è½½ç”¨æˆ·åˆ—è¡¨
            }
        };
        
        // åˆ‡æ¢ç”¨æˆ·çŠ¶æ€ï¼ˆå…¨å±€å‡½æ•°ï¼‰
        window.toggleUserStatus = function(username, status) {
            const newStatus = status === 'active' ? 'inactive' : 'active';
            const statusText = newStatus === 'active' ? 'å¯ç”¨' : 'ç¦ç”¨';
            
            if (confirm(`ç¡®å®šè¦${statusText}ç”¨æˆ· ${username} å—ï¼Ÿ`)) {
                // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥è°ƒç”¨APIåˆ‡æ¢ç”¨æˆ·çŠ¶æ€
                showMessage(`ç”¨æˆ·å·²${statusText}`, 'success');
                loadUsersList(); // é‡æ–°åŠ è½½ç”¨æˆ·åˆ—è¡¨
            }
        };
        
        // ç™»å‡ºæŒ‰é’®äº‹ä»¶å¤„ç†
        logoutBtn.addEventListener('click', async () => {
            if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                try {
                    // æ¸…é™¤æœ¬åœ°å­˜å‚¨
                    localStorage.removeItem('adminToken');
                    localStorage.removeItem('adminInfo');
                    
                    // è·³è½¬åˆ°ç™»å½•é¡µé¢
                    window.location.href = 'login.html';
                } catch (error) {
                    console.error('é€€å‡ºç™»å½•å¤±è´¥:', error);
                }
            }
        });
        

        
        // ä¼ä¸šç®¡ç†ç›¸å…³åŠŸèƒ½
        async function loadCompaniesList() {
            const companiesList = document.getElementById('companies-list');
            companiesList.innerHTML = '<div class="loading-spinner"></div>åŠ è½½ä¸­...';
            
            try {
                // æ¨¡æ‹Ÿæ•°æ®
                const mockCompanies = [
                    { id: '1', name: 'ä½ æ˜¯è°å…¬å¸', status: 'active', createTime: '2024-01-15 10:30:00', verifiedCount: 156 },
                    { id: '2', name: 'ç§‘æŠ€æœ‰é™å…¬å¸', status: 'active', createTime: '2024-01-10 14:20:00', verifiedCount: 89 },
                    { id: '3', name: 'åˆ›æ„å·¥ä½œå®¤', status: 'inactive', createTime: '2024-01-05 09:45:00', verifiedCount: 42 }
                ];
                
                let html = `
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ä¼ä¸šID</th>
                                <th>ä¼ä¸šåç§°</th>
                                <th>çŠ¶æ€</th>
                                <th>åˆ›å»ºæ—¶é—´</th>
                                <th>éªŒè¯æ¬¡æ•°</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                mockCompanies.forEach(company => {
                    const statusBadge = company.status === 'active' 
                        ? '<span class="status-badge approved">å·²æ¿€æ´»</span>'
                        : '<span class="status-badge pending">æœªæ¿€æ´»</span>';
                    
                    html += `
                        <tr>
                            <td>${company.id}</td>
                            <td>${company.name}</td>
                            <td>${statusBadge}</td>
                            <td>${company.createTime}</td>
                            <td>${company.verifiedCount}</td>
                            <td>
                                <div class="action-buttons">
                                    <button class="btn btn-primary btn-sm" onclick="viewCompanyDetails('${company.id}')">æŸ¥çœ‹è¯¦æƒ…</button>
                                    <button class="btn ${company.status === 'active' ? 'btn-danger' : 'btn-success'} btn-sm" 
                                            onclick="${company.status === 'active' ? 'deactivateCompany' : 'activateCompany'}('${company.id}')">
                                        ${company.status === 'active' ? 'åœç”¨' : 'æ¿€æ´»'}
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                html += '</tbody></table>';
                companiesList.innerHTML = html;
            } catch (error) {
                console.error('åŠ è½½ä¼ä¸šåˆ—è¡¨å¤±è´¥:', error);
                companiesList.innerHTML = '<p style="text-align: center; color: #dc3545; padding: 20px;">åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•</p>';
            }
        }
        
        function searchCompanies() {
            const searchTerm = document.getElementById('company-search').value.toLowerCase();
            const companiesList = document.getElementById('companies-list');
            
            // æ¨¡æ‹Ÿæœç´¢åŠŸèƒ½
            companiesList.innerHTML = '<div class="loading-spinner"></div>æœç´¢ä¸­...';
            
            setTimeout(() => {
                // æ¨¡æ‹Ÿæœç´¢ç»“æœ
                const mockCompanies = [
                    { id: '1', name: 'ä½ æ˜¯è°å…¬å¸', status: 'active', createTime: '2024-01-15 10:30:00', verifiedCount: 156 }
                ].filter(c => c.name.toLowerCase().includes(searchTerm));
                
                if (mockCompanies.length === 0) {
                    companiesList.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">æœªæ‰¾åˆ°åŒ¹é…çš„ä¼ä¸š</p>';
                    return;
                }
                
                let html = `
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ä¼ä¸šID</th>
                                <th>ä¼ä¸šåç§°</th>
                                <th>çŠ¶æ€</th>
                                <th>åˆ›å»ºæ—¶é—´</th>
                                <th>éªŒè¯æ¬¡æ•°</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                mockCompanies.forEach(company => {
                    const statusBadge = company.status === 'active' 
                        ? '<span class="status-badge approved">å·²æ¿€æ´»</span>'
                        : '<span class="status-badge pending">æœªæ¿€æ´»</span>';
                    
                    html += `
                        <tr>
                            <td>${company.id}</td>
                            <td>${company.name}</td>
                            <td>${statusBadge}</td>
                            <td>${company.createTime}</td>
                            <td>${company.verifiedCount}</td>
                            <td>
                                <div class="action-buttons">
                                    <button class="btn btn-primary btn-sm" onclick="viewCompanyDetails('${company.id}')">æŸ¥çœ‹è¯¦æƒ…</button>
                                    <button class="btn ${company.status === 'active' ? 'btn-danger' : 'btn-success'} btn-sm" 
                                            onclick="${company.status === 'active' ? 'deactivateCompany' : 'activateCompany'}('${company.id}')">
                                        ${company.status === 'active' ? 'åœç”¨' : 'æ¿€æ´»'}
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                html += '</tbody></table>';
                companiesList.innerHTML = html;
            }, 500);
        }
        
        function viewCompanyDetails(companyId) {
            alert(`æŸ¥çœ‹ä¼ä¸šID: ${companyId} çš„è¯¦æƒ…`);
            // è¿™é‡Œå¯ä»¥å®ç°æŸ¥çœ‹ä¼ä¸šè¯¦æƒ…çš„é€»è¾‘
        }
        
        function activateCompany(companyId) {
            if (confirm('ç¡®å®šè¦æ¿€æ´»è¯¥ä¼ä¸šå—ï¼Ÿ')) {
                alert(`ä¼ä¸šID: ${companyId} å·²æ¿€æ´»`);
                loadCompaniesList();
            }
        }
        
        function deactivateCompany(companyId) {
            if (confirm('ç¡®å®šè¦åœç”¨è¯¥ä¼ä¸šå—ï¼Ÿåœç”¨åå°†æ— æ³•ä½¿ç”¨ç³»ç»ŸåŠŸèƒ½ã€‚')) {
                alert(`ä¼ä¸šID: ${companyId} å·²åœç”¨`);
                loadCompaniesList();
            }
        }
        
        // å‡­è¯ç®¡ç†ç›¸å…³åŠŸèƒ½
        async function loadCredentialsList() {
            const credentialsList = document.getElementById('credentials-list');
            const companySelect = document.getElementById('credentials-company');
            
            credentialsList.innerHTML = '<div class="loading-spinner"></div>åŠ è½½ä¸­...';
            
            // åŠ è½½ä¼ä¸šä¸‹æ‹‰åˆ—è¡¨
            companySelect.innerHTML = '<option value="">æ‰€æœ‰ä¼ä¸š</option>';
            const mockCompanies = [
                { id: '1', name: 'ä½ æ˜¯è°å…¬å¸' },
                { id: '2', name: 'ç§‘æŠ€æœ‰é™å…¬å¸' }
            ];
            
            mockCompanies.forEach(company => {
                companySelect.innerHTML += `<option value="${company.id}">${company.name}</option>`;
            });
            
            try {
                // æ¨¡æ‹Ÿæ•°æ®
                const mockCredentials = [
                    { id: 'cred-001', companyId: '1', companyName: 'ä½ æ˜¯è°å…¬å¸', name: 'å¼ ä¸‰', title: 'æŠ€æœ¯æ€»ç›‘', issueDate: '2024-01-15', expireDate: '2025-01-15', status: 'active' },
                    { id: 'cred-002', companyId: '1', companyName: 'ä½ æ˜¯è°å…¬å¸', name: 'æå››', title: 'äº§å“ç»ç†', issueDate: '2024-01-10', expireDate: '2025-01-10', status: 'active' },
                    { id: 'cred-003', companyId: '2', companyName: 'ç§‘æŠ€æœ‰é™å…¬å¸', name: 'ç‹äº”', title: 'è®¾è®¡å¸ˆ', issueDate: '2024-01-05', expireDate: '2025-01-05', status: 'expired' }
                ];
                
                renderCredentialsTable(mockCredentials);
            } catch (error) {
                console.error('åŠ è½½å‡­è¯åˆ—è¡¨å¤±è´¥:', error);
                credentialsList.innerHTML = '<p style="text-align: center; color: #dc3545; padding: 20px;">åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•</p>';
            }
        }
        
        function renderCredentialsTable(credentials) {
            const credentialsList = document.getElementById('credentials-list');
            
            if (credentials.length === 0) {
                credentialsList.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">æš‚æ— å‡­è¯æ•°æ®</p>';
                return;
            }
            
            let html = `
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>å‡­è¯ID</th>
                            <th>æ‰€å±ä¼ä¸š</th>
                            <th>å§“å</th>
                            <th>èŒä½</th>
                            <th>ç­¾å‘æ—¥æœŸ</th>
                            <th>è¿‡æœŸæ—¥æœŸ</th>
                            <th>çŠ¶æ€</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            credentials.forEach(credential => {
                let statusBadge = '';
                if (credential.status === 'active') {
                    statusBadge = '<span class="status-badge approved">æœ‰æ•ˆ</span>';
                } else if (credential.status === 'expired') {
                    statusBadge = '<span class="status-badge rejected">å·²è¿‡æœŸ</span>';
                } else {
                    statusBadge = '<span class="status-badge pending">å¾…æ¿€æ´»</span>';
                }
                
                html += `
                    <tr>
                        <td>${credential.id}</td>
                        <td>${credential.companyName}</td>
                        <td>${credential.name}</td>
                        <td>${credential.title}</td>
                        <td>${credential.issueDate}</td>
                        <td>${credential.expireDate}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-primary btn-sm" onclick="viewCredentialDetails('${credential.id}')">æŸ¥çœ‹è¯¦æƒ…</button>
                                <button class="btn btn-danger btn-sm" onclick="revokeCredential('${credential.id}')">æ’¤é”€</button>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            credentialsList.innerHTML = html;
        }
        
        function searchCredentials() {
            const companyId = document.getElementById('credentials-company').value;
            const searchTerm = document.getElementById('credentials-search').value.toLowerCase();
            const credentialsList = document.getElementById('credentials-list');
            
            credentialsList.innerHTML = '<div class="loading-spinner"></div>æœç´¢ä¸­...';
            
            setTimeout(() => {
                // æ¨¡æ‹Ÿæœç´¢ç»“æœ
                const mockCredentials = [
                    { id: 'cred-001', companyId: '1', companyName: 'ä½ æ˜¯è°å…¬å¸', name: 'å¼ ä¸‰', title: 'æŠ€æœ¯æ€»ç›‘', issueDate: '2024-01-15', expireDate: '2025-01-15', status: 'active' },
                    { id: 'cred-002', companyId: '1', companyName: 'ä½ æ˜¯è°å…¬å¸', name: 'æå››', title: 'äº§å“ç»ç†', issueDate: '2024-01-10', expireDate: '2025-01-10', status: 'active' }
                ].filter(cred => 
                    (companyId ? cred.companyId === companyId : true) &&
                    (cred.id.toLowerCase().includes(searchTerm) || 
                     cred.name.toLowerCase().includes(searchTerm))
                );
                
                renderCredentialsTable(mockCredentials);
            }, 500);
        }
        
        function viewCredentialDetails(credentialId) {
            alert(`æŸ¥çœ‹å‡­è¯ID: ${credentialId} çš„è¯¦æƒ…`);
        }
        
        function revokeCredential(credentialId) {
            if (confirm('ç¡®å®šè¦æ’¤é”€è¯¥å‡­è¯å—ï¼Ÿæ’¤é”€åå°†æ— æ³•ä½¿ç”¨ã€‚')) {
                alert(`å‡­è¯ID: ${credentialId} å·²æ’¤é”€`);
                loadCredentialsList();
            }
        }
        

    </script>
</body>
</html>